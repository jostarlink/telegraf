<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <link rel="stylesheet" href="assets/style.css?t=d358ee59">
    <link rel="stylesheet" href="docs.css?t=4f015f21">
    <script src="assets/script.js?t=42463e55"></script>
    <title>Telegraf</title>
    <meta name="viewport" content="width=device-width">
  </head>
  <body class="-menu-visible">
    <div class="doc-layout">
      <div class="toggle menu-toggle js-menu-toggle"></div>
      <div class="menu toc-menu">
        <li class="menu-item -level-0 -parent">
          <ul class="submenu">
            <li class="menu-item -level-1 -parent"><a class="link title  link-index" href="index.html">Telegraf</a>
              <ul class="submenu">
                <li class="menu-item -level-2"><a class="link title  link-introduction" href="introduction.html">Introduction</a>
                </li>
                <li class="menu-item -level-2"><a class="link title  link-context" href="context.html">Context</a>
                </li>
                <li class="menu-item -level-2"><a class="link title  link-advanced" href="advanced.html">Advanced usage</a>
                </li>
              </ul>
            </li>
            <li class="menu-item -level-1 -parent"><span class="title">API Reference</span>
              <ul class="submenu">
                <li class="menu-item -level-2"><a class="link title -active link-telegraf" href="telegraf.html">Telegraf</a>
                  <ul class="headings heading-list">
                    <li class="heading-item -depth-3"><a class="hlink link-constructor" href="#constructor">Constructor</a>
                    </li>
                    <li class="heading-item -depth-3"><a class="hlink link-use" href="#use">use</a>
                    </li>
                    <li class="heading-item -depth-3"><a class="hlink link-on" href="#on">on</a>
                    </li>
                    <li class="heading-item -depth-3"><a class="hlink link-hears" href="#hears">hears</a>
                    </li>
                    <li class="heading-item -depth-3"><a class="hlink link-command" href="#command">command</a>
                    </li>
                    <li class="heading-item -depth-3"><a class="hlink link-action" href="#action">action</a>
                    </li>
                    <li class="heading-item -depth-3"><a class="hlink link-gamequery" href="#gamequery">gameQuery</a>
                    </li>
                    <li class="heading-item -depth-3"><a class="hlink link-startpolling" href="#startpolling">startPolling</a>
                    </li>
                    <li class="heading-item -depth-3"><a class="hlink link-startwebhook" href="#startwebhook">startWebhook</a>
                    </li>
                    <li class="heading-item -depth-3"><a class="hlink link-stop" href="#stop">stop</a>
                    </li>
                    <li class="heading-item -depth-3"><a class="hlink link-webhookcallback" href="#webhookcallback">webhookCallback</a>
                    </li>
                    <li class="heading-item -depth-3"><a class="hlink link-handleupdate" href="#handleupdate">handleUpdate</a>
                    </li>
                    <li class="heading-item -depth-3"><a class="hlink link-telegraf.compose" href="#telegraf.compose">Telegraf.compose</a>
                    </li>
                    <li class="heading-item -depth-3"><a class="hlink link-telegraf.mount" href="#telegraf.mount">Telegraf.mount</a>
                    </li>
                    <li class="heading-item -depth-3"><a class="hlink link-telegraf.hears" href="#telegraf.hears">Telegraf.hears</a>
                    </li>
                    <li class="heading-item -depth-3"><a class="hlink link-telegraf.action" href="#telegraf.action">Telegraf.action</a>
                    </li>
                    <li class="heading-item -depth-3"><a class="hlink link-telegraf.passthru" href="#telegraf.passthru">Telegraf.passThru</a>
                    </li>
                    <li class="heading-item -depth-3"><a class="hlink link-telegraf.optional" href="#telegraf.optional">Telegraf.optional</a>
                    </li>
                    <li class="heading-item -depth-3"><a class="hlink link-telegraf.branch" href="#telegraf.branch">Telegraf.branch</a>
                    </li>
                    <li class="heading-item -depth-3"><a class="hlink link-working-with-files" href="#working-with-files">Working with files</a>
                    </li>
                  </ul>
                </li>
                <li class="menu-item -level-2"><a class="link title  link-telegram" href="telegram.html">Telegram</a>
                </li>
                <li class="menu-item -level-2"><a class="link title  link-extra" href="extra.html">Reply markup</a>
                </li>
              </ul>
            </li>
          </ul>
        </li>
      </div>
      <div class="body page-telegraf">
        <div class="header-nav">
          <div class="right"><a class="iconlink" href="https://github.com/telegraf/telegraf" data-title="telegraf/telegraf">
              <!-- span.title Open in GitHub--><span class="icon -github"></span></a>
          </div>
        </div>
        <div class="markdown-body"><h1 id="telegraf">Telegraf</h1>
<p>Telegraf API reference</p>
<pre><code class="lang-js"><span class="pl-k">const</span> Telegraf = <span class="pl-c1">require</span>(<span class="pl-s">&apos;telegraf&apos;</span>)
</code></pre>
<h3 id="constructor">Constructor</h3>
<p>Initialize new Telegraf app.</p>
<p><code>new Telegraf(token, options)</code></p>
<table>
<thead>
<tr>
<th>Param</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>token</td>
<td><code>string</code></td>
<td><a href="https://core.telegram.org/bots#3-how-do-i-create-a-bot">Bot Token</a></td>
</tr>
<tr>
<td>options</td>
<td><code>object</code></td>
<td>Telegraf options</td>
</tr>
</tbody>
</table>
<p>Telegraf options:</p>
<pre><code class="lang-js">{
  <span class="hljs-attr">telegram</span>: {      <span class="pl-c">// Telegram options</span>
    agent: <span class="pl-c1">null</span>    <span class="pl-c">// https.Agent instance, allows custom proxy, certificate, keep alive, etc.</span>
  },
  <span class="hljs-attr">username</span>: <span class="pl-s">&apos;&apos;</span>     <span class="pl-c">// Bot username (optional)  </span>
}
</code></pre>
<h3 id="use">use</h3>
<p>Registers a middleware.</p>
<p><code>telegraf.use(middleware)</code></p>
<table>
<thead>
<tr>
<th>Param</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>middleware</td>
<td><code>function</code></td>
<td>Middleware function</td>
</tr>
</tbody>
</table>
<h3 id="on">on</h3>
<p>Registers middleware for provided update type.</p>
<p><code>telegraf.on(updateTypes, middleware, [middleware...])</code></p>
<table>
<thead>
<tr>
<th>Param</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>updateTypes</td>
<td><code>string</code>|<code>string[]</code></td>
<td>Update type</td>
</tr>
<tr>
<td>middleware</td>
<td><code>function</code></td>
<td>Middleware</td>
</tr>
</tbody>
</table>
<h3 id="hears">hears</h3>
<p>Registers middleware for handling <code>text</code> messages.</p>
<p><code>telegraf.hears(triggers, middleware, [middleware...])</code></p>
<table>
<thead>
<tr>
<th>Param</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>triggers</td>
<td><code>string[]</code>|<code>RegEx[]|Function</code></td>
<td>Triggers</td>
</tr>
<tr>
<td>middleware</td>
<td><code>function</code></td>
<td>Middleware</td>
</tr>
</tbody>
</table>
<h3 id="command">command</h3>
<p>Command handling.</p>
<p><code>telegraf.command(commands, middleware, [middleware...])</code></p>
<table>
<thead>
<tr>
<th>Param</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>triggers</td>
<td><code>string[]</code></td>
<td>Commands</td>
</tr>
<tr>
<td>middleware</td>
<td><code>function</code></td>
<td>Middleware</td>
</tr>
</tbody>
</table>
<h3 id="action">action</h3>
<p>Registers middleware for handling <code>callback_data</code> actions with regular expressions.</p>
<p><code>telegraf.action(triggers, middleware, [middleware...])</code></p>
<table>
<thead>
<tr>
<th>Param</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>triggers</td>
<td><code>string[]</code>|<code>RegEx[]</code></td>
<td>Triggers</td>
</tr>
<tr>
<td>middleware</td>
<td><code>function</code></td>
<td>Middleware</td>
</tr>
</tbody>
</table>
<h3 id="gamequery">gameQuery</h3>
<p>Registers middleware for handling <code>callback_data</code> actions with game query.</p>
<p><code>telegraf.gameQuery(middleware, [middleware...])</code></p>
<table>
<thead>
<tr>
<th>Param</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>middleware</td>
<td><code>function</code></td>
<td>Middleware</td>
</tr>
</tbody>
</table>
<h3 id="startpolling">startPolling</h3>
<p>Start poll updates.</p>
<p><code>telegraf.startPolling(timeout, limit, allowedUpdates)</code></p>
<table>
<thead>
<tr>
<th>Param</th>
<th>Type</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>timeout</td>
<td><code>number</code></td>
<td>30</td>
<td>Poll timeout in seconds</td>
</tr>
<tr>
<td>limit</td>
<td><code>number</code></td>
<td>100</td>
<td>Limits the number of updates to be retrieved</td>
</tr>
<tr>
<td>allowedUpdates</td>
<td><code>string[]</code></td>
<td>null</td>
<td>List the types of updates you want your bot to receive</td>
</tr>
</tbody>
</table>
<h3 id="startwebhook">startWebhook</h3>
<p>Start listening @ <code>https://host:port/webhookPath</code> for Telegram calls.</p>
<p><code>telegraf.startWebhook(webhookPath, tlsOptions, port, [host])</code></p>
<table>
<thead>
<tr>
<th>Param</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>webhookPath</td>
<td><code>string</code></td>
<td>Webhook url path (see Telegraf.setWebhook)</td>
</tr>
<tr>
<td>tlsOptions</td>
<td><code>object</code></td>
<td>(Optional) <a href="https://nodejs.org/api/tls.html#tls_tls_createserver_options_secureconnectionlistener">TLS server options</a>. Pass null to use http</td>
</tr>
<tr>
<td>port</td>
<td><code>number</code></td>
<td>Port number</td>
</tr>
<tr>
<td>[host]</td>
<td><code>string</code></td>
<td>(Optional) Hostname</td>
</tr>
</tbody>
</table>
<h3 id="stop">stop</h3>
<p>Stop Webhook and polling</p>
<p><code>telegraf.stop()</code></p>
<h3 id="webhookcallback">webhookCallback</h3>
<p>Return a callback function suitable for the http[s].createServer() method to handle a request.
You may also use this callback function to mount your telegraf app in a Koa/Connect/Express app.</p>
<p><code>telegraf.webhookCallback(webhookPath) =&gt; Function</code></p>
<table>
<thead>
<tr>
<th>Param</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>webhookPath</td>
<td><code>string</code></td>
<td>Webhook url path (see Telegraf.setWebhook)</td>
</tr>
</tbody>
</table>
<h3 id="handleupdate">handleUpdate</h3>
<p>Handle raw Telegram update.
In case you use centralized webhook server, queue, etc.</p>
<p><code>telegraf.handleUpdate(rawUpdate, [webhookResponse])</code></p>
<table>
<thead>
<tr>
<th>Param</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>rawUpdate</td>
<td><code>object</code></td>
<td>Telegram update payload</td>
</tr>
<tr>
<td>[webhookResponse]</td>
<td><code>object</code></td>
<td>(Optional) <a href="https://nodejs.org/api/http.html#http_class_http_serverresponse">http.ServerResponse</a></td>
</tr>
</tbody>
</table>
<h3 id="telegraf.compose">Telegraf.compose</h3>
<p>Compose <code>middlewares</code> returning a fully valid middleware comprised of all those which are passed.</p>
<p><code>Telegraf.compose(middlewares) =&gt; function</code></p>
<table>
<thead>
<tr>
<th>Param</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>middlewares</td>
<td><code>function[]</code></td>
<td>Array of middlewares</td>
</tr>
</tbody>
</table>
<h3 id="telegraf.mount">Telegraf.mount</h3>
<p>Generates middleware for handling provided update types.</p>
<p><code>Telegraf.mount(updateTypes, middleware) =&gt; function</code></p>
<table>
<thead>
<tr>
<th>Param</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>updateTypes</td>
<td><code>string</code>|<code>string[]</code></td>
<td>Update type</td>
</tr>
<tr>
<td>middleware</td>
<td><code>function</code></td>
<td>middleware</td>
</tr>
</tbody>
</table>
<h3 id="telegraf.hears">Telegraf.hears</h3>
<p>Generates middleware for handling <code>text</code> messages with regular expressions.</p>
<p><code>Telegraf.hears(triggers, middleware) =&gt; function</code></p>
<table>
<thead>
<tr>
<th>Param</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>triggers</td>
<td><code>string[]</code>|<code>RegEx[]</code>|<code>Function[]</code></td>
<td>Triggers</td>
</tr>
<tr>
<td>handler</td>
<td><code>function</code></td>
<td>Handler</td>
</tr>
</tbody>
</table>
<h3 id="telegraf.action">Telegraf.action</h3>
<p>Generates middleware for handling <code>callbackQuery</code> data with regular expressions.</p>
<p><code>Telegraf.action(triggers, middleware) =&gt; function</code></p>
<table>
<thead>
<tr>
<th>Param</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>triggers</td>
<td><code>string[]</code>|<code>RegEx[]</code>|<code>Function[]</code></td>
<td>Triggers</td>
</tr>
<tr>
<td>handler</td>
<td><code>function</code></td>
<td>Handler</td>
</tr>
</tbody>
</table>
<h3 id="telegraf.passthru">Telegraf.passThru</h3>
<p>Generates pass thru middleware.</p>
<p><code>Telegraf.passThru() =&gt; function</code></p>
<h3 id="telegraf.optional">Telegraf.optional</h3>
<p>Generates optional middleware.</p>
<p><code>Telegraf.optional(test, middleware) =&gt; function</code></p>
<table>
<thead>
<tr>
<th>Param</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>test</td>
<td><code>truthy</code>|<code>function</code></td>
<td>Value or predicate <code>(ctx) =&gt; bool</code></td>
</tr>
<tr>
<td>middleware</td>
<td><code>function</code></td>
<td>middleware</td>
</tr>
</tbody>
</table>
<h3 id="telegraf.branch">Telegraf.branch</h3>
<p>Generates branch middleware.</p>
<p><code>Telegraf.branch(test, trueMiddleware, falseMiddleware) =&gt; function</code></p>
<table>
<thead>
<tr>
<th>Param</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>test</td>
<td><code>truthy</code>|<code>function</code></td>
<td>Value or predicate <code>(ctx) =&gt; bool</code></td>
</tr>
<tr>
<td>trueMiddleware</td>
<td><code>function</code></td>
<td>true action  middleware</td>
</tr>
<tr>
<td>falseMiddleware</td>
<td><code>function</code></td>
<td>false action middleware</td>
</tr>
</tbody>
</table>
<h3 id="working-with-files">Working with files</h3>
<p>Supported file sources:</p>
<ul>
<li><code>Existing file_id</code></li>
<li><code>File path</code></li>
<li><code>Url</code></li>
<li><code>Buffer</code></li>
<li><code>ReadStream</code></li>
</ul>
<p>Also you can provide optional name of file as <code>filename</code>.</p>
<pre><code class="lang-js">
  <span class="pl-c">// resend existing file by file_id</span>
  telegram.sendSticker(<span class="pl-s">&apos;chatId&apos;</span>, <span class="pl-s">&apos;123123jkbhj6b&apos;</span>)

  <span class="pl-c">// send file</span>
  telegram.sendVideo(<span class="pl-s">&apos;chatId&apos;</span>, {
    <span class="hljs-attr">source</span>: <span class="pl-s">&apos;/path/to/video.mp4&apos;</span>
  })

   <span class="pl-c">// send stream</span>
  telegram.sendVideo(<span class="pl-s">&apos;chatId&apos;</span>, {
    <span class="hljs-attr">source</span>: fs.createReadStream(<span class="pl-s">&apos;/path/to/video.mp4&apos;</span>)
  })
  
  <span class="pl-c">// send buffer</span>
  telegram.sendVoice(<span class="pl-s">&apos;chatId&apos;</span>, {
    <span class="hljs-attr">source</span>: <span class="pl-k">new</span> Buffer()
  })

  <span class="pl-c">// send url</span>
  telegram.sendPhoto(<span class="pl-s">&apos;chatId&apos;</span>, {
    <span class="hljs-attr">url</span>: <span class="pl-s">&apos;http://lorempixel.com/400/200/cats/&apos;</span>,
    <span class="hljs-attr">filename</span>: <span class="pl-s">&apos;kitten.jpg&apos;</span>
  })
</code></pre>
<p><em>FYI: Telegram servers detect content type using file extension (May 2016).</em></p>
<p><sub><a href="https://core.telegram.org/bots/api#file">Related Telegram api docs</a></sub></p>

        </div>
        <div class="footer-nav">
          <div class="left"><a href="advanced.html"><span class="title">Advanced usage</span></a></div>
          <div class="right"><a href="telegram.html"><span class="label">Next: </span><span class="title">Telegram</span></a></div>
        </div>
      </div>
    </div>
  </body>
</html>